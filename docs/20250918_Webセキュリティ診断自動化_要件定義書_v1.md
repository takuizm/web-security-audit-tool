# Webセキュリティ診断自動化システム 要件定義書

**文書番号**: 20250918_Webセキュリティ診断自動化_要件定義書_v1
**作成日**: 2025年9月18日
**版数**: v1.0

## 1. 概要

### 1.1 目的
複数のWebサイトに対してセキュリティ診断を自動的に実施し、統一された形式でレポートを生成するシステムを構築する。

### 1.2 対象範囲
- CSV形式で指定された複数URLの自動診断
- 8つのセキュリティ項目の自動チェック
- 診断結果のレポート生成
- ログ管理機能

## 2. 機能要件

### 2.1 診断対象項目

#### 2.1.1 コンポーネントの脆弱性
- **評価基準**: 非推奨のバージョン利用フレームワーク、言語、OS等が使用されていないこと
- **調査手法**:
  - Wappalyzer（domsignal）
  - Burp Suite
  - DeveloperTool
- **調査方法**:
  - https://domsignal.com/js-vulnerability-scanner
  - wappalyzer（JQライブラリ）
  - ChromeDevツール「$.fn.jquery」

#### 2.1.2 暗号化通信
- **評価基準**: 非暗号化通信による接続が許可されていないこと（常時SSL化推奨）
- **調査手法**: Browser
- **調査方法**:
  - httpアクセス可能な場合はNG
  - httpsにてhttpでアクセスできるページがあればNG
  - httpページからhttpsまたは404ページへリダイレクトせずエラーが表示される場合はNG

#### 2.1.3 セキュリティ設定（TLS1.3）
- **評価基準**: TLS1.3が有効であること
- **調査手法**: domsignal.com
- **調査方法**: https://domsignal.com/tls-test

#### 2.1.4 セキュリティ設定（TLS1.1以前）
- **評価基準**: TLS1.1以前が無効であること（2023年9月改訂）
- **調査手法**: domsignal.com
- **調査方法**: https://domsignal.com/tls-test

#### 2.1.5 アクセス制御（インデックス）
- **評価基準**: 公開不要と推測されるコンテンツが検索エンジンにインデックスされていないこと
- **調査手法**: site:URL検索
- **調査方法**:
  - site:URL "index of", site:URL "login", site:URL "inline:password"
  - "index of"は、ページタイトルに"index of"がつくもの、つまりディレクトリ一覧を公開しているホームページの検索

#### 2.1.6 アクセス制御（サーバアクセス）
- **評価基準**: 公開不要と推測されるサーバへのアクセスが制限されていること
- **調査手法**: Security Trails
- **調査方法**:
  - https://securitytrails.com/dns-trails
  - IPアドレスやサブドメインでアクセスした場合、セキュリティ上見せるべきではないページが見えないこと
  - IPアドレスのままアクセスできる
  - テストサイトにアクセスできる

#### 2.1.7 セキュリティ設定（セキュリティヘッダー）
- **評価基準**: HTTPレスポンスヘッダによるセキュリティ対策が十分であること（X-Frame-Options Strict-Transport-Security Content-Security-Policy）
- **調査手法**: Developer Tool, domsignal.com
- **調査方法**: https://domsignal.com/secure-header-test

### 2.2 入力仕様
- **入力形式**: CSV形式
- **必須フィールド**: URL
- **オプションフィールド**: サイト名、優先度、備考等

### 2.3 出力仕様
- **レポート形式**:
  - JSON形式（機械可読）
  - HTML形式（人間可読）
  - CSV形式（集計用）
- **出力項目**:
  - 診断対象URL
  - 各セキュリティ項目の評価結果（OK/NG/警告）
  - 詳細情報
  - 推奨対応策
  - 診断実行日時

## 3. 非機能要件

### 3.1 性能要件
- **処理速度**: 1URLあたり平均30秒以内での診断完了
- **同時処理**: 最大5URLの並行処理
- **スケーラビリティ**: 100URL以上の一括処理対応

### 3.2 可用性要件
- **稼働時間**: 24時間365日利用可能
- **エラー処理**: 個別URL診断失敗時も他URLの処理継続
- **リトライ機能**: ネットワークエラー時の自動再試行（最大3回）

### 3.3 セキュリティ要件
- **認証情報管理**: APIキー等の機密情報の安全な管理
- **ログ管理**: 診断実行ログの記録と保管
- **データ保護**: 診断結果の適切な保護

### 3.4 運用要件
- **ログ出力**: 詳細な実行ログの出力
- **設定管理**: YAML形式での設定ファイル管理
- **バックアップ**: 診断結果の自動バックアップ

## 4. システム構成

### 4.1 アーキテクチャ概要
```
[CSV入力] → [診断エンジン] → [レポート生成] → [出力ファイル]
     ↓           ↓              ↓
[設定管理] → [ログ管理] → [エラーハンドリング]
```

### 4.2 主要コンポーネント
1. **入力処理モジュール**: CSV読み込み、バリデーション
2. **診断エンジン**: 各セキュリティ項目の自動チェック
3. **外部API連携モジュール**: domsignal.com等との連携
4. **レポート生成モジュール**: 結果の整形と出力
5. **設定管理モジュール**: 設定ファイルの管理
6. **ログ管理モジュール**: 実行ログの記録

### 4.3 技術スタック
- **言語**: Python 3.9+
- **主要ライブラリ**:
  - requests: HTTP通信
  - beautifulsoup4: HTML解析
  - selenium: ブラウザ自動化
  - pandas: データ処理
  - pyyaml: 設定管理
  - jinja2: レポートテンプレート

## 5. 外部システム連携

### 5.1 外部サービス
- **domsignal.com**: TLS設定、セキュリティヘッダーチェック
- **Wappalyzer**: 技術スタック検出
- **Google検索API**: site:検索による情報収集
- **SecurityTrails**: DNS/サブドメイン情報取得

### 5.2 API制限対応
- **レート制限**: 各APIの制限に応じた適切な間隔での実行
- **エラーハンドリング**: API障害時の代替手段
- **認証管理**: APIキーの安全な管理

## 6. 運用要件

### 6.1 実行方式
- **バッチ実行**: コマンドライン経由での一括実行
- **スケジュール実行**: 定期実行への対応
- **対話実行**: 個別URL診断への対応

### 6.2 監視・ログ
- **実行ログ**: 詳細な処理状況の記録
- **エラーログ**: 例外・エラー情報の記録
- **結果ログ**: 診断結果サマリーの記録

### 6.3 保守性
- **設定外部化**: 診断項目・基準の設定ファイル化
- **モジュール化**: 機能別の独立したモジュール設計
- **テスト容易性**: 単体テスト・結合テストの実装

## 7. 制約事項

### 7.1 技術的制約
- 一部診断項目は外部サービスに依存
- ネットワーク環境による実行時間の変動
- 対象サイトのアクセス制限による診断制限

### 7.2 運用制約
- 外部APIの利用制限
- 診断対象サイトへの負荷配慮
- 法的・倫理的な診断範囲の制限

## 8. 今後の拡張予定

### 8.1 診断項目の拡張
- OWASP Top 10項目への対応
- モバイル対応診断
- アクセシビリティ診断

### 8.2 機能拡張
- Web UI提供
- 継続監視機能
- アラート通知機能

---

**承認者**: [承認者名]
**承認日**: [承認日]
